import{c as J,u as K,d as L,g as W}from"./index-jlyN47MZ.js";import{E as S,A as X,B as Y,r as ee,C as ae,D as te,F as le,G as ne}from"./element-k04-Ygsx.js";import{Z as z,l as oe,r as y,b as re,ag as i,aq as se,m,p as ie,V as $,M as g,O as a,T as e,u as r,S as s,q as k,R as ue,Q as de}from"./vue-ZDMaqQfr.js";import{_ as ce}from"./index-djXECPeb.js";import"./vxe-4ZPAR52n.js";const pe={total:0,currentPage:1,pageSizes:[10,20,50],pageSize:10,layout:"total, sizes, prev, pager, next, jumper"};function me(x={}){const c=z({...pe,...x});return{paginationData:c,handleCurrentChange:C=>{c.currentPage=C},handleSizeChange:C=>{c.pageSize=C}}}const fe={class:"app-container"},_e={class:"toolbar-wrapper"},ge={class:"table-wrapper"},ve={class:"pager-wrapper"},he=oe({name:"ElementPlus",__name:"index",setup(x){const c=y(!1),{paginationData:o,handleCurrentChange:P,handleSizeChange:C}=me(),f=y(!1),T=y(null),u=z({username:"",password:""}),q=z({username:[{required:!0,trigger:"blur",message:"请输入用户名"}],password:[{required:!0,trigger:"blur",message:"请输入密码"}]}),N=()=>{var n;(n=T.value)==null||n.validate((l,b)=>{l?v.value===void 0?J(u).then(()=>{S.success("新增成功"),h()}).finally(()=>{f.value=!1}):K({id:v.value,username:u.username}).then(()=>{S.success("修改成功"),h()}).finally(()=>{f.value=!1}):console.error("表单校验不通过",b)})},M=()=>{v.value=void 0,u.username="",u.password=""},I=n=>{X.confirm(`正在删除用户：${n.username}，确认删除？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{L(n.id).then(()=>{S.success("删除成功"),h()})})},v=y(void 0),j=n=>{v.value=n.id,u.username=n.username,f.value=!0},D=y([]),B=y(null),_=z({username:"",phone:""}),h=()=>{c.value=!0,W({currentPage:o.currentPage,size:o.pageSize,username:_.username||void 0,phone:_.phone||void 0}).then(n=>{o.total=n.data.total,D.value=n.data.list}).catch(()=>{D.value=[]}).finally(()=>{c.value=!1})},U=()=>{o.currentPage===1?h():o.currentPage=1},G=()=>{var n;(n=B.value)==null||n.resetFields(),U()};return re([()=>o.currentPage,()=>o.pageSize],h,{immediate:!0}),(n,l)=>{const b=i("el-input"),w=i("el-form-item"),d=i("el-button"),R=i("el-form"),A=i("el-card"),E=i("el-tooltip"),p=i("el-table-column"),V=i("el-tag"),O=i("el-table"),Q=i("el-pagination"),Z=i("el-dialog"),F=se("loading");return m(),ie("div",fe,[$((m(),g(A,{shadow:"never",class:"search-wrapper"},{default:a(()=>[e(R,{ref_key:"searchFormRef",ref:B,inline:!0,model:_},{default:a(()=>[e(w,{prop:"username",label:"用户名"},{default:a(()=>[e(b,{modelValue:_.username,"onUpdate:modelValue":l[0]||(l[0]=t=>_.username=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(w,{prop:"phone",label:"手机号"},{default:a(()=>[e(b,{modelValue:_.phone,"onUpdate:modelValue":l[1]||(l[1]=t=>_.phone=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(w,null,{default:a(()=>[e(d,{type:"primary",icon:r(Y),onClick:U},{default:a(()=>[s("查询")]),_:1},8,["icon"]),e(d,{icon:r(ee),onClick:G},{default:a(()=>[s("重置")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),_:1})),[[F,c.value]]),$((m(),g(A,{shadow:"never"},{default:a(()=>[k("div",_e,[k("div",null,[e(d,{type:"primary",icon:r(ae),onClick:l[2]||(l[2]=t=>f.value=!0)},{default:a(()=>[s("新增用户")]),_:1},8,["icon"]),e(d,{type:"danger",icon:r(te)},{default:a(()=>[s("批量删除")]),_:1},8,["icon"])]),k("div",null,[e(E,{content:"下载"},{default:a(()=>[e(d,{type:"primary",icon:r(le),circle:""},null,8,["icon"])]),_:1}),e(E,{content:"刷新当前页"},{default:a(()=>[e(d,{type:"primary",icon:r(ne),circle:"",onClick:h},null,8,["icon"])]),_:1})])]),k("div",ge,[e(O,{data:D.value},{default:a(()=>[e(p,{type:"selection",width:"50",align:"center"}),e(p,{prop:"username",label:"用户名",align:"center"}),e(p,{prop:"roles",label:"角色",align:"center"},{default:a(t=>[t.row.roles==="admin"?(m(),g(V,{key:0,effect:"plain"},{default:a(()=>[s("admin")]),_:1})):(m(),g(V,{key:1,type:"warning",effect:"plain"},{default:a(()=>[s(ue(t.row.roles),1)]),_:2},1024))]),_:1}),e(p,{prop:"phone",label:"手机号",align:"center"}),e(p,{prop:"email",label:"邮箱",align:"center"}),e(p,{prop:"status",label:"状态",align:"center"},{default:a(t=>[t.row.status?(m(),g(V,{key:0,type:"success",effect:"plain"},{default:a(()=>[s("启用")]),_:1})):(m(),g(V,{key:1,type:"danger",effect:"plain"},{default:a(()=>[s("禁用")]),_:1}))]),_:1}),e(p,{prop:"createTime",label:"创建时间",align:"center"}),e(p,{fixed:"right",label:"操作",width:"150",align:"center"},{default:a(t=>[e(d,{type:"primary",text:"",bg:"",size:"small",onClick:H=>j(t.row)},{default:a(()=>[s("修改")]),_:2},1032,["onClick"]),e(d,{type:"danger",text:"",bg:"",size:"small",onClick:H=>I(t.row)},{default:a(()=>[s("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),k("div",ve,[e(Q,{background:"",layout:r(o).layout,"page-sizes":r(o).pageSizes,total:r(o).total,"page-size":r(o).pageSize,currentPage:r(o).currentPage,onSizeChange:r(C),onCurrentChange:r(P)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])]),_:1})),[[F,c.value]]),e(Z,{modelValue:f.value,"onUpdate:modelValue":l[6]||(l[6]=t=>f.value=t),title:v.value===void 0?"新增用户":"修改用户",onClose:M,width:"30%"},{footer:a(()=>[e(d,{onClick:l[5]||(l[5]=t=>f.value=!1)},{default:a(()=>[s("取消")]),_:1}),e(d,{type:"primary",onClick:N},{default:a(()=>[s("确认")]),_:1})]),default:a(()=>[e(R,{ref_key:"formRef",ref:T,model:u,rules:q,"label-width":"100px","label-position":"left"},{default:a(()=>[e(w,{prop:"username",label:"用户名"},{default:a(()=>[e(b,{modelValue:u.username,"onUpdate:modelValue":l[3]||(l[3]=t=>u.username=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),v.value===void 0?(m(),g(w,{key:0,prop:"password",label:"密码"},{default:a(()=>[e(b,{modelValue:u.password,"onUpdate:modelValue":l[4]||(l[4]=t=>u.password=t),placeholder:"请输入"},null,8,["modelValue"])]),_:1})):de("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),Ve=ce(he,[["__scopeId","data-v-2a953a43"]]);export{Ve as default};
